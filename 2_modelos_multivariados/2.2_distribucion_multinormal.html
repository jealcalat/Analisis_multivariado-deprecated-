<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>distribucion_multinormal</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="2.2_distribucion_multinormal_files/libs/clipboard/clipboard.min.js"></script>
<script src="2.2_distribucion_multinormal_files/libs/quarto-html/quarto.js"></script>
<script src="2.2_distribucion_multinormal_files/libs/quarto-html/popper.min.js"></script>
<script src="2.2_distribucion_multinormal_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="2.2_distribucion_multinormal_files/libs/quarto-html/anchor.min.js"></script>
<link href="2.2_distribucion_multinormal_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="2.2_distribucion_multinormal_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="2.2_distribucion_multinormal_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="2.2_distribucion_multinormal_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="2.2_distribucion_multinormal_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="modelos-de-distribución-multivariados" class="level1">
<h1>2. Modelos de distribución multivariados</h1>
<p align="right">
Autor: Emmanuel Alcalá <br> <a href="https://scholar.google.com.mx/citations?hl=en&amp;user=3URusCgAAAAJ&amp;view_op=list_works&amp;sortby=pubdate">Google Scholar</a>
</p>
<p align="left">
<br> <a href="https://jealcalat.github.io/Analisis_multivariado/">Regresar a la página del curso</a>
</p>
<hr>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="23">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cargar algunas funciones que se utilizarán para simular y graficar</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"../r_scripts/utilities.r"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="distribución-multinormal" class="level2">
<h2 class="anchored" data-anchor-id="distribución-multinormal">2.2. Distribución multinormal</h2>
<p>Ya vimos que para la distribución normal univariada, la función de densidad está dada por</p>
<p><span class="math display">\[
  p(x) = \frac{1}{\sigma \sqrt{2\pi}} e\left\{\frac{-(x-\mu)^2}{2\sigma^2}\right\}  \tag{8}
\]</span></p>
<p>Cuando <span class="math inline">\(\mu = 0, \sigma = 1\)</span>, la ecuación (8) es una distribución especial llamada <em>distribución normal estándar</em>. La distribución normal estándar <span class="math inline">\(\mathcal{N}(0, 1)\)</span> tiene ciertas propiedades interesantes:</p>
<ol type="1">
<li>En el intervalo <span class="math inline">\(\left[\mu - \sigma, \mu + \sigma \right]\)</span> se cubre el 0.683 del área total, es decir, <span class="math inline">\(p(\mu - \sigma \leq X \leq \mu + \sigma) \approx 0.68\)</span>.</li>
<li>En el intervalo <span class="math inline">\(\left[\mu - 2\sigma, \mu + 2\sigma \right]\)</span> se cubre el .954 del área total.</li>
<li>El área en <span class="math inline">\(X \leq \mu - \sigma\)</span> es <span class="math inline">\(1 - p(X &gt; \mu - \sigma)\)</span></li>
</ol>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="24">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dado que la distribución es simétrica, p(mu - sigma &lt;= X &lt;= mu+sigma)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># la región mu-sigma es igual que mu+sigma, por lo tanto, es suficiente</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># con restarle a 1 la probabilidad p(mu-sigma &lt;= X) * 2</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>(<span class="dv">1</span> <span class="sc">-</span> (<span class="fu">pnorm</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)) <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>(<span class="dv">1</span> <span class="sc">-</span> (<span class="fu">pnorm</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)) <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># con 3 sigma cubre el 99 % del espacio</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>(<span class="dv">1</span> <span class="sc">-</span> (<span class="fu">pnorm</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)) <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># la probabilidad de x &lt;= mu-sigma es</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> (<span class="fu">pnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># o equivalentemente</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>(<span class="fu">pnorm</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
0.683
</div>
<div class="cell-output cell-output-display">
0.954
</div>
<div class="cell-output cell-output-display">
0.997
</div>
<div class="cell-output cell-output-display">
0.159
</div>
<div class="cell-output cell-output-display">
0.159
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="25">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fijar tamaño de gráficos</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repr.plot.width =</span> <span class="dv">10</span>, <span class="at">repr.plot.height =</span> <span class="dv">4</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># graficar normal estándar</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># colores</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>red_light <span class="ot">&lt;-</span> <span class="st">"#be1b1b75"</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>blue_light <span class="ot">&lt;-</span> <span class="st">"#B3B3FF"</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>green_light <span class="ot">&lt;-</span> <span class="st">"#77f475"</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"p(x)"</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.first =</span> {</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">axis</span>(<span class="dv">1</span>,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">at =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">:</span><span class="dv">2</span>),</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">parse</span>(<span class="at">text =</span> <span class="fu">c</span>(<span class="st">"mu-2*sigma"</span>, <span class="st">"mu-sigma"</span>, <span class="st">"mu"</span>, <span class="st">"mu+sigma"</span>, <span class="st">"mu+2*sigma"</span>))</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co"># función cargada en utilities.R</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co"># graficar area de x entre [mu-sigma, mu+sigma]</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_area_normal</span>(</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">from_x =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">to_x =</span> <span class="dv">1</span>,</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> blue_light</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="co"># graficar área de mu-2sigma &lt;= x &lt;= mu-sigma</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_area_normal</span>(</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">from_x =</span> <span class="sc">-</span><span class="dv">2</span>,</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">to_x =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> red_light</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_area_normal</span>(</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">from_x =</span> <span class="dv">1</span>,</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">to_x =</span> <span class="dv">2</span>,</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> green_light</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="co"># anotación de proporción de la curva</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>x_lab_pos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span> <span class="sc">/</span> <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">3</span> <span class="sc">/</span> <span class="dv">2</span>) <span class="co"># posición en x</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>y_lab_pos <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x_lab_pos, <span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span> <span class="co"># posición en y</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> x_lab_pos,</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y_lab_pos,</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># a la izquierda de la zona azul es</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">pnorm</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>),</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">-</span> (<span class="fu">pnorm</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)) <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>),</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">pnorm</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>)</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">x0 =</span> <span class="fu">c</span>(x_lab_pos[<span class="dv">1</span>] <span class="sc">*</span> <span class="fl">0.8</span>, x_lab_pos[<span class="dv">3</span>] <span class="sc">*</span> <span class="fl">0.8</span>),</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">y0 =</span> <span class="fu">c</span>(y_lab_pos[<span class="dv">1</span>], y_lab_pos[<span class="dv">3</span>]),</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">x1 =</span> <span class="fu">rep</span>(<span class="fl">1.5</span>, <span class="dv">2</span>),</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">y1 =</span> <span class="fu">dnorm</span>(<span class="fu">rep</span>(<span class="fl">1.5</span>, <span class="dv">2</span>)) <span class="sc">*</span> <span class="fl">2.5</span>,</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">length =</span> <span class="fl">0.15</span>,</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">code =</span> <span class="dv">1</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fl">1.5</span>,</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">dnorm</span>(<span class="fl">1.5</span>) <span class="sc">*</span> <span class="fl">2.6</span>,</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"sum = {(0.954 - 0.683)} + 0.683 = {0.683 + (0.954 - 0.683)}"</span>)</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2.2_distribucion_multinormal_files/figure-html/cell-4-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>El término en el exponente en la ecuación (8)</p>
<p><span class="math display">\[
  \frac{(x-\mu)^2}{2\sigma^2}
\]</span></p>
<p>Puede ser convenientemente reescrito como</p>
<p><span class="math display">\[
  \frac{(x-\mu)^2}{2\sigma^2} = (x - \mu)(\sigma^2)^{-1}(x-\mu)
\]</span></p>
<p>Para mostrar que este término mide el cuadrado de la distancia entre <span class="math inline">\(x\)</span> y <span class="math inline">\(\mu\)</span> en unidades de desviación estándar. Esta distancia ser generalizada para un vector <span class="math inline">\(\mathbf{x} \in \mathbb{R}^D\)</span> de <span class="math inline">\(D\)</span> variables como</p>
<p><span class="math display">\[
  (\mathbf{x}-\boldsymbol{\mu})^\top \boldsymbol{\Sigma}^{-1}(\mathbf{x}-\boldsymbol{\mu}) \tag{9}
\]</span></p>
<p>A la ecuación (9) se le conoce como distancia de Mahalanobis (en realidad, el cuadrado de la distancia de Mahalanobis), que es la distancia entre un punto y su distribución (univariada o multivariada). El significado de los parámetros se describe en la siguiente sección.</p>
<section id="distribución-bivariada" class="level3">
<h3 class="anchored" data-anchor-id="distribución-bivariada">2.2.1. Distribución bivariada</h3>
<p>La distribución normal multivariada (MVN) se caracteriza completamente por el vector de medias <span class="math inline">\(\boldsymbol{\mu}\)</span> y la matriz de covarianzas <span class="math inline">\(\boldsymbol{\Sigma}\)</span></p>
<p><span class="math display">\[
  p(\mathbf{x} \mid \boldsymbol{\mu},\boldsymbol{\Sigma}) = \frac{1}{(2\pi)^{D/2}|\boldsymbol{\Sigma}|^{1/2}}e\left\{ -\frac{1}{2}(\boldsymbol{y}-\boldsymbol{\mu})^\top \boldsymbol{\Sigma}^{-1}(\boldsymbol{y}-\boldsymbol{\mu}) \right\} \tag{10}
\]</span></p>
<p>En donde <span class="math inline">\(\boldsymbol{\mu}=\mathbb{E}[y]\)</span> y <span class="math inline">\(D=\text{dim}(\boldsymbol{y})\)</span> (la dimensión de <span class="math inline">\(\boldsymbol{y}\)</span>; en el caso de una normal bivariada <span class="math inline">\(D=2\)</span>). <span class="math inline">\(\boldsymbol{\Sigma}\)</span> es la matriz simétrica <span class="math inline">\(D\times D\)</span> de covarianza. En <span class="math inline">\(D=2\)</span> (bivariada), <span class="math inline">\(\boldsymbol{\Sigma}\)</span> es</p>
<p><span class="math display">\[
  \boldsymbol{\Sigma} = \begin{bmatrix}
  \sigma_1^2 &amp; \sigma_{12}^2\\
  \sigma_{21}^2 &amp; \sigma_{2}^2
  \end{bmatrix}
\]</span></p>
<p>Como se vio en la lección 1, el coeficiente de correlación <span class="math inline">\(\rho\)</span> es igual a la covarianza <span class="math inline">\(\sigma_{12}^2\)</span> dividida por el producto de las desviaciones estándar <span class="math inline">\(\sigma_1\sigma_2\)</span></p>
<p><span class="math display">\[
  \rho_{X_1,X_2} = \frac{\sigma_{12}^2}{\sigma_1\sigma_2}
\]</span></p>
<p>Por lo que, despejando, tenemos <span class="math inline">\(\sigma_{12}^2 = \rho\sigma_1\sigma_2\)</span>. La matriz de covarianzas puede ser reescrita como</p>
<p><span class="math display">\[
  \boldsymbol{\Sigma} = \begin{bmatrix}
  \sigma_1^2 &amp; \rho\sigma_1\sigma_2\\
  \rho\sigma_1\sigma_2 &amp; \sigma_{2}^2
  \end{bmatrix} \tag{11}
\]</span></p>
<p>El determinante <span class="math inline">\(|\Sigma|\)</span> para la bivariada es, de acuerdo con la ecuación (2)</p>
<p><span class="math display">\[
\begin{align*}
  \text{det}(\Sigma) &amp;= \sigma_1^2\sigma_2^2 - (\rho\sigma_1\sigma_2)^2\\
                     &amp;= \sigma_1^2\sigma_2^2 - \rho^2\sigma_1^2\sigma_2^2\\
                     &amp;= \sigma_1^2\sigma_2^2(1-\rho^2) \tag{12}
\end{align*}
\]</span></p>
<p>Esta forma de representar la distribución bivariada (aplica también para al MVN) enfatiza la influencia de la correlación en la pdf conjunta. En la siguiente sección simulamos dicha influencia.</p>
<p><strong>Propiedades de la MVN</strong>:</p>
<ol type="1">
<li>Las combinaciones lineales de los componentes de <span class="math inline">\(\mathbf{x}\sim \mathcal{N}(\boldsymbol{\mu}, \boldsymbol{\Sigma})\)</span> también están distribuidas normalmente, <span class="math inline">\(\mathbf{a^\top x} = a_1x_1 + \dots + a_Dx_D \sim \mathcal{N}(\boldsymbol{a^\top\mu}, \boldsymbol{a^\top\Sigma})\)</span></li>
<li>Covarianza de cero implica que los componentes de <span class="math inline">\(\mathbf{x}\)</span> están distribuidos independientemente.</li>
<li>Las distribuciones condicionales de los componentes, e.g., <span class="math inline">\(x_1 | x_2\)</span> (<span class="math inline">\(x_1\)</span> dado <span class="math inline">\(x_2\)</span>), también están distribuidas normalmente, con media <span class="math inline">\(\mu_1 + \frac{\sigma_{12}}{\sigma_{22}}(x_2 - \mu_2)\)</span> y desviación estándar <span class="math inline">\(\sigma_{11}(1-\rho_{12}^2)\)</span> (para el caso de la bivariada, <span class="math inline">\(\rho_{12}=\rho\)</span>), es decir, <span class="math display">\[
x_1|x_2 \sim \mathcal{N}\left(%
  \mu_1 + \frac{\sigma_{12}}{\sigma_{22}}(x_2 - \mu_2),\sigma_{11}(1-\rho_{12}^2)%
  \right)
\]</span></li>
</ol>
<section id="muestras-bivariadas" class="level4">
<h4 class="anchored" data-anchor-id="muestras-bivariadas">Muestras bivariadas</h4>
<p>Algoritmo para generar muestras <span class="math inline">\(\mathbf{x} \sim \mathcal{N}(\boldsymbol{\mu}, \boldsymbol{\Sigma})\)</span><a name="cite_ref-1" href=""></a><a href="#cite_note-1"><sup>[1]</sup></a> con media aribitraria <span class="math inline">\(\mathbf{x}\)</span> y matriz de covarianza <span class="math inline">\(\boldsymbol{\Sigma}\)</span> con generador gaussiano (i.e., normal):</p>
<ol type="1">
<li>Computar la <a href="../Preliminares_AL.ipynb">factorización de Cholesky</a> <span class="math inline">\(L\)</span> de una matriz positiva definida <span class="math inline">\(\boldsymbol{\Sigma}=LL^\top\)</span>, en donde <span class="math inline">\(L\)</span> es la matriz <a href="../Preliminares_AL.ipynb">triangular inferior</a>.</li>
<li>Generar una muestra <span class="math inline">\(\mathbf{u} \sim \mathcal{N}(\mathbf{0}, I)\)</span> (normal estándar).</li>
<li>Computar <span class="math inline">\(\mathbf{x} = \boldsymbol{\mu} + L\mathbf{u}\)</span>, que tendrá la distribución deseada.</li>
</ol>
<p><a name="cite_note-1" href=""></a>1. [^](#cite_ref-1) C. E. Rasmussen &amp; C. K. I. Williams (2006). <em>Gaussian Processes for Machine Learning</em>. The MIT Press, 2006</p>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="26">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repr.plot.width =</span> <span class="dv">7</span>, <span class="at">repr.plot.height =</span> <span class="dv">6</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.6</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>sigma_1 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>sigma_2 <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># por ecuación 11</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>( <span class="co"># matriz de covarianza</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    sigma_1<span class="sc">^</span><span class="dv">2</span>, rho <span class="sc">*</span> sigma_1 <span class="sc">*</span> sigma_2,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    rho <span class="sc">*</span> sigma_1 <span class="sc">*</span> sigma_2, sigma_2<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>mu_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1, mu2)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">chol</span>(Sigma))</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>L <span class="co"># matriz triangular</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">2</span> <span class="sc">*</span> N), <span class="dv">2</span>, N) <span class="co"># 2 filas, N/2 columnas</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co"># sumar element-wise, mu1 + col_1, mu2 + col_2</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> (mu_vec <span class="sc">+</span> <span class="fu">t</span>(L <span class="sc">%*%</span> u))</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter_plot</span>(</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  x[, <span class="dv">1</span>], x[, <span class="dv">2</span>],</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dos formas diferentes de anotaciones matemáticas</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="fu">parse</span>(<span class="at">text =</span> <span class="st">"x[1]"</span>), <span class="at">ylab =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> red_light, <span class="at">fill =</span> blue_light</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A matrix: 2 × 2 of type dbl</caption>
<tbody>
    <tr><td> 2.0</td><td>0.0</td></tr>
    <tr><td>-4.8</td><td>6.4</td></tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<p><img src="2.2_distribucion_multinormal_files/figure-html/cell-5-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>Ahora vamos a evaluar el efecto de <span class="math inline">\(\rho\)</span> sobre la distribución bivariada. Primero, recordar de la ecuación (9)</p>
<p><span class="math display">\[
  d_M^2 = (\mathbf{x}-\boldsymbol{\mu})^\top \boldsymbol{\Sigma}^{-1}(\mathbf{x}-\boldsymbol{\mu}) \tag{9}
\]</span></p>
<p>Es la distancia cuadrada de Mahalanobis, que mide la distancia de un punto <span class="math inline">\(p=(x_1, x_2)\)</span> al centroide $ = $, considerando la correlación, a diferencia de la distancia euclideana. Notar que, dado que depende de <span class="math inline">\(\boldsymbol{\Sigma}\)</span>, está influenciada por la correlación.</p>
<p>Vamos a notar algunas cosas sobre <span class="math inline">\(d_M^2\)</span>:</p>
<ol type="1">
<li>Todos los valores de <span class="math inline">\(\mathbf{x}\)</span> cuyo valor de <span class="math inline">\(d_M^2\)</span> son iguales tienen la misma densidad <span class="math inline">\(f(\mathbf{x})\)</span>.</li>
<li>A medida que <span class="math inline">\(d_M^2\)</span> incrementa, <span class="math inline">\(f(\mathbf{x})\)</span> <em>decrece</em>.</li>
<li>A medida que <span class="math inline">\(d_M^2\)</span> incrementa la distancia entre <span class="math inline">\(\mathbf{x}\)</span> y <span class="math inline">\(\boldsymbol{\mu}\)</span> incrementa, esto equivale a que un valor se mueva hacia las colas de una distribución.</li>
<li>La variable <span class="math inline">\(d_M^2\)</span> tiene una distribución <span class="math inline">\(\chi^2\)</span> con <span class="math inline">\(p\)</span> grados de libertad, en donde <span class="math inline">\(p\)</span> es la dimensión de <span class="math inline">\(\mathbf{x}\)</span>. Se pueden obtener valores de <span class="math inline">\(d_M\)</span> obteniendo el valor en <span class="math inline">\(x\)</span> de la distribución acumulada de <span class="math inline">\(\chi^2\)</span> que corresponde a un cuantil (una proporción del área bajo la curva). Abajo se ilustra la forma de una distribución de <span class="math inline">\(\chi^2\)</span> con 3 grados de libertad.</li>
<li>El cuantil en <span class="math inline">\(\chi^2(1-\alpha,df=p)\)</span> corresponde al cuadrado del radio de un (hiper)-elipse, en donde <span class="math inline">\(1-\alpha\)</span> es un nivel de significancia (una densidad de probabilidad).</li>
</ol>
<p>Los puntos 2 y 3 permiten obtener una aplicación interesante: dado que los puntos se alejan del centro de la distribución, un punto que tenga una distancia de Mahalanobis probablemente no pertenece a la distribución, es decir es un outlier.</p>
<p>Los puntos 4 y 5 permite construir elipses de confianza (análogos a los intervalos de confianza para 2D), lo que facilita la visualización.</p>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repr.plot.width=</span><span class="dv">7</span>, <span class="at">repr.plot.height=</span><span class="dv">5</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="fl">0.75</span>, <span class="dv">0</span>),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">las =</span> <span class="dv">1</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">3</span>),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">'density of x'</span>,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">'x'</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="fu">expression</span>(chi<span class="sc">^</span><span class="dv">2</span><span class="sc">~</span>pdf),</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">'blue'</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2.2_distribucion_multinormal_files/figure-html/cell-6-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="28">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>rho_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.6</span>, <span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.6</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>sigma_1 <span class="ot">&lt;-</span> <span class="dv">2</span><span class="co">#</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>sigma_2 <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>sigma_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(sigma_1, sigma_2)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>mu_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">0.5</span>, <span class="dv">0</span>),</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (rho <span class="cf">in</span> rho_vec) {</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">sim_bivariate</span>(rho, sigma_vec, mu_vec, <span class="at">N =</span> <span class="dv">200</span>, <span class="at">seed =</span> <span class="dv">145</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scatter_plot</span>(</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    x[, <span class="dv">1</span>], x[, <span class="dv">2</span>],</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">"x1"</span>,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"x2"</span>,</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> green_light,</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> red_light,</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="fu">parse</span>(<span class="at">text =</span> <span class="fu">sprintf</span>(<span class="st">"rho == %s~y~hat(rho)==%s"</span>, rho, <span class="fu">cor</span>(x[, <span class="dv">1</span>], x[, <span class="dv">2</span>]) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)))</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  rad <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="at">p =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, .<span class="dv">95</span>), <span class="at">df =</span> <span class="fu">ncol</span>(x))</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  rad <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(rad)</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_ellipse</span>(x, rad, <span class="at">colores =</span> <span class="fu">c</span>(<span class="st">"navy"</span>, <span class="st">"red"</span>))</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2.2_distribucion_multinormal_files/figure-html/cell-7-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="29">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ahora veremos cómo se relacionan los eigenvectores y eigenvalores</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># con los ejes del elipse</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repr.plot.width =</span> <span class="dv">7</span>, <span class="at">repr.plot.height =</span> <span class="dv">7</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>sigma_1 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>sigma_2 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>mu_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sim_bivariate</span>(<span class="fl">0.6</span>, <span class="fu">c</span>(sigma_1, sigma_2), mu_vec, <span class="dv">200</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter_plot</span>(</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> x[ ,<span class="dv">1</span>], <span class="at">y =</span> x[ ,<span class="dv">2</span>],</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> blue_light, <span class="at">fill =</span> red_light,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">range</span>(x), <span class="at">ylim =</span> <span class="fu">range</span>(x),</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Bivariate normal &amp; error ellipse"</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>])</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>rad <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="at">p =</span> .<span class="dv">95</span>, <span class="at">df =</span> <span class="fu">ncol</span>(x))</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>rad <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(rad)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co"># radio a mu + sd, approx </span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>rad2 <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="fl">0.6826895</span>, <span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">sqrt</span>()</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ellipse</span>(x, rad2, <span class="at">colores =</span> <span class="fu">c</span>(<span class="st">'navy'</span>, <span class="st">'red'</span>))</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>covX <span class="ot">&lt;-</span> <span class="fu">cov</span>(x)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>eigVal <span class="ot">&lt;-</span> <span class="fu">eigen</span>(covX)<span class="sc">$</span>values</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>eigVec <span class="ot">&lt;-</span> <span class="fu">eigen</span>(covX)<span class="sc">$</span>vectors</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co"># media empírica (vector)</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>emp_mean <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(x)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="co"># obtener el eigenvector correspondiente al eigenvalor más largo</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>max_eigen_val_index <span class="ot">&lt;-</span> <span class="fu">which.max</span>(eigVal)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>max_eigVal <span class="ot">&lt;-</span> eigVal[max_eigen_val_index]</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>max_eigVec <span class="ot">&lt;-</span> eigVec[, max_eigen_val_index]</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="co"># correspondiente al eigenvalor más corto</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>min_eigVal <span class="ot">&lt;-</span> eigVal[<span class="sc">-</span>max_eigen_val_index]</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>min_eigVec <span class="ot">&lt;-</span> eigVec[ ,<span class="sc">-</span>max_eigen_val_index]</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="co"># dibujar el eje mayor</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># x0, y0</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>  emp_mean[<span class="dv">1</span>], emp_mean[<span class="dv">2</span>],</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># x1</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>  emp_mean[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">sqrt</span>(max_eigVal) <span class="sc">*</span> max_eigVec[<span class="dv">1</span>] <span class="sc">*</span> rad2, </span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># y1</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>  emp_mean[<span class="dv">2</span>] <span class="sc">+</span> <span class="fu">sqrt</span>(max_eigVal) <span class="sc">*</span> max_eigVec[<span class="dv">2</span>] <span class="sc">*</span> rad2,</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">'navy'</span>,</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a><span class="co"># dibujar el eje menor</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>  emp_mean[<span class="dv">1</span>], emp_mean[<span class="dv">2</span>],</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>  emp_mean[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">sqrt</span>(min_eigVal) <span class="sc">*</span> min_eigVec[<span class="dv">1</span>] <span class="sc">*</span> rad2,</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>  emp_mean[<span class="dv">2</span>] <span class="sc">+</span> <span class="fu">sqrt</span>(min_eigVal) <span class="sc">*</span> min_eigVec[<span class="dv">2</span>] <span class="sc">*</span> rad2,</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"navy"</span>,</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2.2_distribucion_multinormal_files/figure-html/cell-8-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Notar que los eigenvectores son ortogonales entre sí (su producto punto es 0, <code>eigVec[,1] %*% eigVec[,2]</code>). Luego en el tema de PCA veremos que el eigenvector correspondiente al eigenvalor más largo corresponde al componente principal 1, que es el componente en una matriz en donde existe mayor variación.</p>
<p><strong>Ejemplo</strong></p>
<p>Suponer una distribución bivariada normal <span class="math inline">\(X\sim \mathcal{N}(\bm\mu, \Sigma)\)</span> con centroide</p>
<p><span class="math display">\[
  \boldsymbol{\mu} = \begin{bmatrix}
  3.1 \\ 3.0
  \end{bmatrix}
\]</span></p>
<p>Y matriz de covarianzas</p>
<p><span class="math display">\[
  \Sigma = \begin{bmatrix}
    0.7163324 &amp; 0.6876791\\
    0.6876791 &amp; 1.0601719
  \end{bmatrix}
\]</span></p>
<p>Cuya inversa <span class="math inline">\(\Sigma^{-1}\)</span> (ver los Preliminares de esta Notebook)</p>
<p><span class="math display">\[
  \Sigma^{-1}=\begin{bmatrix}
    3.7 &amp; -2.4\\
   -2.4 &amp; 2.5
  \end{bmatrix}
\]</span></p>
<ol type="1">
<li>Encontrar la distancia euclideana de los puntos <span class="math inline">\(p_1 = (5, 5), p_2 = (5, 2)\)</span> con respecto a <span class="math inline">\(\bm\mu\)</span>.</li>
<li>Encontrar <span class="math inline">\(d_M\)</span>, la distancia cuadrática de Malahanobis.</li>
<li>Verificar si <span class="math inline">\(p_1, p_2\)</span> son outliers de acuerdo a <span class="math inline">\(d_M\)</span> y su distribución, al <span class="math inline">\(\alpha = 0.05\)</span> de confianza.</li>
</ol>
<p><em>Solución</em></p>
<ol type="1">
<li>Con respecto a <span class="math inline">\(\bm\mu\)</span>, tenemos para <span class="math inline">\(p_1\)</span></li>
</ol>
<p><span class="math display">\[
  d_E = \sqrt{(5-3.1)^2 + (5-3)^2} = 2.7586
\]</span></p>
<p>y para <span class="math inline">\(p_2\)</span></p>
<p><span class="math display">\[
  d_E = \sqrt{(5-3.1)^2 + (2-3)^2} = 2.147
\]</span></p>
<p>Ambos puntos están muy próximos al centroide.</p>
<ol start="2" type="1">
<li>Para la distancia de Malahanobis, usamos su definición (9)</li>
</ol>
<p><span class="math display">\[
  d_M = \sqrt{(\mathbf{x}-\boldsymbol{\mu})^\top \boldsymbol{\Sigma}^{-1}(\mathbf{x}-\boldsymbol{\mu})}
\]</span></p>
<p>Para <span class="math inline">\(p_1\)</span> da</p>
<p><span class="math display">\[
  d_M = \sqrt{
    \begin{bmatrix}
    5-3.1\\
    5-3
    \end{bmatrix}^\top
    \begin{bmatrix}
    3.7 &amp; -2.4\\
   -2.4 &amp; 2.5
    \end{bmatrix}
    \begin{bmatrix}
    5-3.1\\
    5-3
    \end{bmatrix}
  } = \sqrt{
    \begin{bmatrix}
    1.9 &amp; 2
    \end{bmatrix}
    \begin{bmatrix}
    3.7 &amp; -2.4\\
   -2.4 &amp; 2.5
    \end{bmatrix}
    \begin{bmatrix}
    1.9 \\ 2
    \end{bmatrix}
  } = \sqrt{5.117} = 2.26
\]</span></p>
<p>Para <span class="math inline">\(p_2\)</span></p>
<p><span class="math display">\[
  d_M = \sqrt{
    \begin{bmatrix}
    5-3.1\\
    2-3
    \end{bmatrix}^\top
    \begin{bmatrix}
    3.7 &amp; -2.4\\
   -2.4 &amp; 2.5
    \end{bmatrix}
    \begin{bmatrix}
    5-3.1\\
    2-3
    \end{bmatrix}
  } = \sqrt{
    \begin{bmatrix}
    1.9 &amp; -1
    \end{bmatrix}
    \begin{bmatrix}
    3.7 &amp; -2.4\\
   -2.4 &amp; 2.5
    \end{bmatrix}
    \begin{bmatrix}
    1.9 \\ -1
    \end{bmatrix}
  } = \sqrt{24.977} = 4.9976
\]</span></p>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="30">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># En R lo anterior sería</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># matriz inversa</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>Sinv <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">3.7</span>, <span class="sc">-</span><span class="fl">2.4</span>, <span class="sc">-</span><span class="fl">2.4</span>, <span class="fl">2.5</span>), <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># vector centroide</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">3.1</span>, <span class="dv">3</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># distancia euclideana p1</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>))</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">norm</span>(p1<span class="sc">-</span>mu, <span class="at">type =</span> <span class="st">'2'</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">2</span>))</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="fu">norm</span>(p2 <span class="sc">-</span> mu, <span class="at">type =</span> <span class="st">"2"</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># d de Malahanobis de p1; %*% es el producto punto, t(x) es la traspuesta de x</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">t</span>(p1<span class="sc">-</span>mu) <span class="sc">%*%</span> Sinv <span class="sc">%*%</span> (p1<span class="sc">-</span>mu))</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># d de Malahanobis de p2</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">t</span>(p2<span class="sc">-</span>mu) <span class="sc">%*%</span> Sinv <span class="sc">%*%</span> (p2<span class="sc">-</span>mu))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
2.75862284482674
</div>
<div class="cell-output cell-output-display">
2.14709105535839
</div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A matrix: 1 × 1 of type dbl</caption>
<tbody>
    <tr><td>2.262079</td></tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A matrix: 1 × 1 of type dbl</caption>
<tbody>
    <tr><td>4.997699</td></tr>
</tbody>
</table>
</div>
</div>
<p>Verificamos ahora si <span class="math inline">\(p_1, p_2\)</span> son outliers considerando que la distancia de Mahalanobis al cuadrado tiene distribución <span class="math inline">\(\chi^2\)</span> con <span class="math inline">\(1-\alpha\)</span> nivel de significancia y <span class="math inline">\(\dim(X)=2\)</span> grados de libertad. En R <code>qchisq(1-alfa, 2)</code> nos da el valor de <span class="math inline">\(d_M^2\)</span> al <span class="math inline">\(1-\alpha\)</span> de confianza, por lo que si le sacamos la raíz cuadrada obtendríamos el valor <span class="math inline">\(d_M\)</span> <em>teórico</em> con el que sería igual, o por encima del cual, nuestro punto <span class="math inline">\(p_i\)</span> podría ser un outlier.</p>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="31">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>d_teorico_cuadratico <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span>, <span class="dv">2</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(d_teorico_cuadratico)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
2.44774683068082
</div>
</div>
<p>Vemos que <span class="math inline">\(d_M\)</span> de <span class="math inline">\(p_1\)</span> es menor a este valor, pero <span class="math inline">\(d_M\)</span> de <span class="math inline">\(p_2\)</span> (4.99) no lo es. Por lo tanto, al <span class="math inline">\(1-\alpha\)</span> de confianza, concluimos que <span class="math inline">\(p_2\)</span> es un outlier.</p>
</section>
<section id="gráficos-marginales-usando" class="level4">
<h4 class="anchored" data-anchor-id="gráficos-marginales-usando">Gráficos marginales usando</h4>
<p>Los gráficos de histogramas marginales al gráfico de dispersión pueden aportar información adicional que no es del todo visible con el mero gráfico de dispersión. Por ejemplo, la existencia de outliers, la normalidad de las distribuciones marginales, etc.</p>
<ol type="1">
<li>Opción <code>{ggplot}</code> y <code>{ggExtra}</code>.</li>
<li>Opción <code>{base}</code> usando la función <code>scatter_marginal()</code> personalizada del script <code>utilities</code>.</li>
</ol>
<section id="opción-1" class="level5">
<h5 class="anchored" data-anchor-id="opción-1">Opción 1</h5>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="32">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggExtra)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(x) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"X1"</span>, <span class="st">"X2"</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>p_scatter <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> X2)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggMarginal</span>(p_scatter, <span class="at">type =</span> <span class="st">"densigram"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
Warning message:
“The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.
ℹ Please use `after_stat(density)` instead.
ℹ The deprecated feature was likely used in the ggExtra package.
  Please report the issue at &lt;https://github.com/daattali/ggExtra/issues&gt;.”</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2.2_distribucion_multinormal_files/figure-html/cell-11-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="opción-2" class="level5">
<h5 class="anchored" data-anchor-id="opción-2">Opción 2</h5>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="34">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># revisar el código del script utilities.r</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter_marginal</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> x[, <span class="dv">1</span>], <span class="at">y =</span> x[, <span class="dv">2</span>],</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> blue_light, <span class="at">color =</span> <span class="dv">1</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]), </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex.lab =</span> <span class="fl">1.4</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2.2_distribucion_multinormal_files/figure-html/cell-12-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>